rpmcliInstall 
rpmgiSetArgs 612
rpmgiGlobArgv
rpmgiEscapeSpaces

rpmcliInstallElementPath

rpmgiNext
rpmgiLoadReadHeader
rpmgiLoadManifest loop?
rpmgiReadHeader target
rpmgiOpen
rpmExpand
Fopen
rpm-5.4.9/lib/rpmgi.c

/usr/bin/rpm -i http://128.224.162.188/xtrans-doc-1.2.6-r0.armv7a_vfp.rpm
error: http://128.224.162.188/xtrans-doc-1.2.6-r0.armv7a_vfp.rpm: Signature: sigh sigSize(920): BAD, Fstat(2) failederror: reading (null) manifest, non-printable characters found

#0  Fstat (fd=0x2a560, st=0xbefef850) at rpmrpc.c:1444
#1  0xb6f1b218 in printSize (datalen=12572, pad=0, siglen=920, fd=0x2a560) at pkgio.c:729
#2  rdSignature (fd=<optimized out>, ptr=0xbefff9b4, msg=0xbefff9bc) at pkgio.c:988
#3  0xb6f17a32 in rpmReadPackageFile (ts=0x30158, fd=0x2a560, fn=0x311f0 "http://128.224.162.188/xtrans-doc-1.2.6-r0.armv7a_vfp.rpm", 
    hdrp=0xbefff9f4) at package.c:130
#4  0xb6f9a520 in rpmgiReadHeader (gi=0x30530, path=0x311f0 "http://128.224.162.188/xtrans-doc-1.2.6-r0.armv7a_vfp.rpm") at rpmgi.c:163
#5  0xb6f9ab10 in rpmgiLoadReadHeader (gi=0x30530) at rpmgi.c:232
#6  rpmgiNext (gi=0x30530) at rpmgi.c:742
#7  0xb6f9bc2e in rpmcliInstall (ts=<optimized out>, ia=0x15a7c <rpmIArgs@@LIBRPM_0>, argv=<optimized out>) at rpminstall.c:613
#8  0x0000a77c in main (argc=<optimized out>, argv=<optimized out>) at ./rpmqv.c:1041

cvtfmode (f=<synthetic pointer>, end=<synthetic pointer>, other=0xbefff984 "", stdio=0xbefff970 "", m=0x31278 "r.fdio", nstdio=<optimized out>, 
    nother=<optimized out>) at rpmio.c:2647



(gdb) p *fd
$248 = {_item = {use = 0x2a640, pool = 0x17c90, next = 0x0}, flags = 0, magic = 71708984, nfps = 1, fps = {{io = 0xb6ec6714 <ufdio_s>, fp = 0x331a0, 
      fdno = 5}, {io = 0xb6ec66f8 <fpio_s>, fp = 0x331a0, fdno = -1}, {io = 0x0, fp = 0x0, fdno = 0}, {io = 0x0, fp = 0x0, fdno = 0}, {io = 0x0, 
      fp = 0x0, fdno = 0}, {io = 0x0, fp = 0x0, fdno = 0}, {io = 0x0, fp = 0x0, fdno = 0}, {io = 0x0, fp = 0x0, fdno = 0}}, u = 0x312e0, req = 0x0, 
  rd_timeoutsecs = 120, bytesRemain = 13492, contentLength = 13588, persist = 0, wr_chunked = 0, syserrno = 0, errcookie = 0x0, opath = 0x0, 
  oflags = 0, omode = 0, xar = 0x0, dig = 0x332c8, stats = 0x319c8, ndigests = 0, digests = 0x0, contentType = 0x0, contentDisposition = 0x0, 
  lastModified = 0, ftpFileDoneNeeded = 0, fd_cpioPos = 0}
#0  ufdRead (cookie=0x2a560, buf=0x33550 "\355\253\356\333\003", count=96) at rpmio.c:1994
#1  0xb6f189b4 in rdLead (fd=0x2a560, ptr=0x0, msg=0xbefff9bc) at pkgio.c:566
#2  0xb6f1791a in rpmReadPackageFile (ts=0x30158, fd=0x2a560, fn=0x311f0 "http://128.224.162.188/xtrans-doc-1.2.6-r0.armv7a_vfp.rpm", 
    hdrp=0xbefff9f4) at package.c:113
#3  0xb6f9a508 in rpmgiReadHeader (gi=0x30530, path=0x311f0 "http://128.224.162.188/xtrans-doc-1.2.6-r0.armv7a_vfp.rpm") at rpmgi.c:163
#4  0xb6f9aaf8 in rpmgiLoadReadHeader (gi=0x30530) at rpmgi.c:232
#5  rpmgiNext (gi=0x30530) at rpmgi.c:742
#6  0xb6f9bc16 in rpmcliInstall (ts=<optimized out>, ia=0x15a7c <rpmIArgs@@LIBRPM_0>, argv=<optimized out>) at rpminstall.c:613
#7  0x0000a77c in main (argc=<optimized out>, argv=<optimized out>) at ./rpmqv.c:1041

in rdLead {
timedread = ufdRead
rpmlead magic, l->signature_type == 5;RPMSIGTYPE_HEADERSIG
l->major may be 3.

}

rdSignature {
block
$256 = {32025998, 0, 117440512, 402849792}

(gdb) p ei
$269 = (rpmuint32_t *) 0xb6ffe000
(gdb) p pvlen
$270 = 912
(gdb) p prot
$271 = 3
(gdb) p flags
$272 = 34
(gdb) p fdno
$273 = -1
(gdb) p off
$274 = 0
(gdb) 

854     if ((xx = (int) timedRead(fd, (char *)&ei[2], nb)) != (int) nb) {
ufdRead (cookie=0x2a560, buf=0xb6ffe008 "", count=904) at rpmio.c:194

    if (entry->info.tag == RPMTAG_HEADERSIGNATURES)
 p entry->info     
$280 = {tag = RPMTAG_HEADERSIGNATURES, type = RPM_BIN_TYPE, offset = 152, count = 16}

915 line
p *info
$289 = {tag = 1040187392, type = 0, offset = 0, count = 0}

ril = 6

1443 int Fstat(FD_t fd, struct stat * st)
1444 {
1445     const char * path = fdGetOPath(fd);
}
}


