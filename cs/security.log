---
tags: [ cs ] 
title: Security
date: 2015-02-27T15:46:14+08:00 
category: cs
---

[1]: http://www.kroah.com/linux/talks/ols_2002_lsm_paper/lsm.pdf
[2]: https://www.computernetworkingnotes.com/rhce-study-guide/selinux-explained-with-examples-in-easy-language.html

# Glossary
[ASN.1 vs DER vs PEM vs x509 vs PKCS#7 vs ....](https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/)
[What are the differences between PEM, DER, P7B/PKCS#7, PFX/PKCS#12 certificates](https://myonlineusb.wordpress.com/2011/06/19/what-are-the-differences-between-pem-der-p7bpkcs7-pfxpkcs12-certificates/)kk
PEM

# LSM
include/linux/lsm_hooks.h
[Linux Security Module Framework][1]
# x509 
Unique Identifiers should be the fingerprint

# RSA
https://www.ietf.org/rfc/rfc3447.txt

# Cert self-signed
commit ad3043fda39db0361d9601685356db4512e914be
Author: David Howells <dhowells@redhat.com>
Date:   Wed Apr 6 16:13:34 2016 +0100

    X.509: Fix self-signed determination
    
    There's a bug in the code determining whether a certificate is self-signed
    or not: if they have neither AKID nor SKID then we just assume that the
    cert is self-signed, which may not be true.
    
    Fix this by checking that the raw subject name matches the raw issuer name
    and that the public key algorithm for the key and signature are both the
    same in addition to requiring that the AKID bits match.
    
    Signed-off-by: David Howells <dhowells@redhat.com>



# SELinux
[SELinux Explained with Examples in Easy Language]
security/selinux/selinuxfs.c: sysfs_create_mount_point: create /sys/fs/selinux mount point. then mount the selinuxfs on selinux_null???
upstart will mount selinuxfs at /sys/fs/selinux
bash-4.3# mount
/dev/sda2 on / type ext3 (ro,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered)
proc on /proc type proc (rw,relatime)
sysfs on /sys type sysfs (rw,relatime)
bash-4.3# cat /proc/cmdline 
BOOT_IMAGE=vmlinuz rootwait max_loop=255 ro clock=pit console=ttyS0,115200 root=LABEL=wr_usb_boot initrd=initrd init=/bin/bash selinux=1 
bash-4.3# ls /sys/fs/selinux/
bash-4.3# cat /proc/filesystems  | grep selinux
nodev	selinuxfs
bash-4.3# mount -t selinuxfs selinuxfs /sys/fs/selinux/

# IMA
__fput ->ima_file_free ->ima_check_last_writer
## Digital signature
[What is a Digital Signature?](http://www.youdzone.com/signature.html)
Doc =>hasing()=>Message digest=>Encrypt with Private Key()=>Signature=>Decrypt with Public Key()=>Message digest=>Compare with hashing Doc()=>OK?
## Hook point
include/linux/ima.h

## IMA behaviors
1. if no kernel cmdline parameters + apply policy + default enabled appraise, wont work dmesg shows miss-hash. Need ima_tcb and ima_appraise_tcb
# Capabilities
## Multikey
1. SYSTEM_EXTRA_CERTIFICATE c4c361059585
[KEYS: Support for inserting a certificate into x86 bzImage](https://patchwork.kernel.org/patch/9193883/)
certs/Kconfig
system_certificate_list
Porting certs patches from 4.3
2. [ IMA: Use the the system trusted keyrings instead of .ima_mok](https://patchwork.kernel.org/patch/8504271/)


# Cryptograhy
* Side-channel attack Timing attack: 

    crypto: crypto_memneq - add equality testing of memory regions w/o timing leaks
    
    commit 6bf37e5aa90f18baf5acf4874bca505dd667c37f upstream.

EVM: Use crypto_memneq() for digest comparisons
613317bd212c585c20796c10afe5daaa95d4b0a1

# network security
* spoofing attack
* Side-channel attack 


# etc
Improper Access Control
netlink: fix possible spoofing from non-root processes
	20e1db19db5d6b9e4e83021595eab0dc8f107bef
